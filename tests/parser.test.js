const Parser = require('../src/parser');

describe('test tokenize blank and ignored lines', () => {
    test('handle ignored lines', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/ignored-only.txt');
        const geojson = openairParser.toGeojson();

        expect(geojson.features.length).toEqual(0);
    });
});

describe('test parse complete airspace definition blocks', () => {
    test('parse airspace with simple polygon geometry', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/polygon-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: 'a3236278-6b6e-4bf6-a511-418863afcc84',
                    properties: {
                        name: 'ED-R10B Todendorf-Putlos MON-SAT+',
                        class: 'R',
                        upperCeiling: {
                            value: 40000,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                        lowerCeiling: {
                            value: 0,
                            unit: 'FT',
                            referenceDatum: 'GND',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [10.666666666666666, 54.416666666666664],
                                [10.833333333333334, 54.416666666666664],
                                [10.883333333333333, 54.43333333333333],
                                [10.883333333333333, 54.325],
                                [10.683333333333334, 54.25],
                                [10.666666666666666, 54.25527777777778],
                                [10.666666666666666, 54.416666666666664],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });

    test('parse airspace with circular geometry', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/circular-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: 'da2c17bf-cef1-4460-972d-572087e40edd',
                    properties: {
                        name: 'ED-R3 Geesthacht H24',
                        class: 'R',
                        upperCeiling: {
                            value: 2200,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                        lowerCeiling: {
                            value: 0,
                            unit: 'FT',
                            referenceDatum: 'GND',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [10.419444444444444, 53.425265398894226],
                                [10.417513856061632, 53.425229231113505],
                                [10.415590896649324, 53.425120870693235],
                                [10.413683164914845, 53.42494074583215],
                                [10.411798199161039, 53.424689568307244],
                                [10.409943447388256, 53.424368330650445],
                                [10.408126237759891, 53.423978302211665],
                                [10.406353749550334, 53.423521024124554],
                                [10.404632984692013, 53.422998303194774],
                                [10.402970740035723, 53.42241220473559],
                                [10.401373580435395, 53.421765044379555],
                                [10.39984781276498, 53.42105937889916],
                                [10.39839946097114, 53.420297996073394],
                                [10.397034242261128, 53.41948390364081],
                                [10.395757544520418, 53.418620317383414],
                                [10.394574405049493, 53.417710648389246],
                                [10.393489490703729, 53.416758489544385],
                                [10.392507079514411, 53.415767601308765],
                                [10.391631043862784, 53.41474189683237],
                                [10.390864835272643, 53.41368542647132],
                                [10.390211470880299, 53.4126023617656],
                                [10.389673521633815, 53.411496978942324],
                                [10.389253102266473, 53.41037364200995],
                                [10.388951863082056, 53.4092367855109],
                                [10.388770983582365, 53.40809089700086],
                                [10.38871116795986, 53.406940499324264],
                                [10.388772642470888, 53.40579013275609],
                                [10.388955154697452, 53.404644337080775],
                                [10.389257974698042, 53.403507633678686],
                                [10.389679898040448, 53.40238450769107],
                                [10.390219250702316, 53.401279390333606],
                                [10.390873895817679, 53.400196641428245],
                                [10.3916412422407, 53.399140532221715],
                                [10.392518254890767, 53.39811522855839],
                                [10.393501466836234, 53.39712477447334],
                                [10.394586993067437, 53.39617307626972],
                                [10.395770545903282, 53.39526388714288],
                                [10.397047451969366, 53.39440079241113],
                                [10.398412670679768, 53.39358719541083],
                                [10.399860814148997, 53.39282630411075],
                                [10.401386168455177, 53.39212111849776],
                                [10.402982716170639, 53.391474418783076],
                                [10.404644160071202, 53.39088875447459],
                                [10.406363947931323, 53.39036643435803],
                                [10.408135298308052, 53.38990951742559],
                                [10.409951227213254, 53.38951980478731],
                                [10.411804575570319, 53.38919883259646],
                                [10.413688037348557, 53.38894786601645],
                                [10.41559418826623, 53.3887678942524],
                                [10.417515514950932, 53.38865962666691],
                                [10.419444444444444, 53.38862348999464],
                                [10.421373373937959, 53.38865962666691],
                                [10.42329470062266, 53.3887678942524],
                                [10.425200851540335, 53.38894786601645],
                                [10.427084313318574, 53.38919883259646],
                                [10.428937661675636, 53.38951980478731],
                                [10.43075359058084, 53.38990951742559],
                                [10.432524940957567, 53.39036643435803],
                                [10.434244728817688, 53.39088875447459],
                                [10.435906172718253, 53.391474418783076],
                                [10.437502720433713, 53.39212111849776],
                                [10.439028074739895, 53.39282630411075],
                                [10.44047621820912, 53.39358719541083],
                                [10.441841436919525, 53.39440079241113],
                                [10.443118342985608, 53.39526388714288],
                                [10.444301895821456, 53.39617307626972],
                                [10.445387422052658, 53.39712477447334],
                                [10.446370633998121, 53.39811522855839],
                                [10.447247646648192, 53.399140532221715],
                                [10.448014993071213, 53.400196641428245],
                                [10.448669638186574, 53.401279390333606],
                                [10.44920899084844, 53.40238450769107],
                                [10.44963091419085, 53.403507633678686],
                                [10.449933734191436, 53.404644337080775],
                                [10.450116246418004, 53.40579013275609],
                                [10.45017772092903, 53.406940499324264],
                                [10.450117905306527, 53.40809089700086],
                                [10.449937025806836, 53.4092367855109],
                                [10.449635786622418, 53.41037364200995],
                                [10.449215367255077, 53.411496978942324],
                                [10.448677418008593, 53.4126023617656],
                                [10.448024053616246, 53.41368542647132],
                                [10.447257845026108, 53.41474189683237],
                                [10.446381809374477, 53.415767601308765],
                                [10.445399398185163, 53.416758489544385],
                                [10.444314483839399, 53.417710648389246],
                                [10.443131344368473, 53.418620317383414],
                                [10.441854646627762, 53.41948390364081],
                                [10.440489427917752, 53.420297996073394],
                                [10.43904107612391, 53.42105937889916],
                                [10.437515308453497, 53.421765044379555],
                                [10.435918148853169, 53.42241220473559],
                                [10.43425590419688, 53.422998303194774],
                                [10.432535139338558, 53.423521024124554],
                                [10.430762651129001, 53.423978302211665],
                                [10.428945441500636, 53.424368330650445],
                                [10.42709068972785, 53.424689568307244],
                                [10.425205723974047, 53.42494074583215],
                                [10.423297992239565, 53.425120870693235],
                                [10.421375032827259, 53.425229231113505],
                                [10.419444444444444, 53.425265398894226],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });

    test('parse airspace with clockwise arc geometry', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/arc-clockwise-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: '2c2880a0-c908-4b73-af43-5ac440b82fe2',
                    properties: {
                        name: 'ED-R56 Kummersdorf MON-FRI',
                        class: 'R',
                        upperCeiling: {
                            value: 3500,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                        lowerCeiling: {
                            value: 0,
                            unit: 'FT',
                            referenceDatum: 'GND',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [13.392777777777777, 52.126666666666665],
                                [13.418888888888889, 52.1325],
                                [13.41888888888889, 52.1325],
                                [13.42130306051576, 52.1329895361755],
                                [13.42376259017737, 52.13338500635156],
                                [13.426257756627397, 52.13368484726553],
                                [13.428778697061437, 52.13388787364201],
                                [13.431315446286261, 52.13399328290128],
                                [13.433857976303763, 52.13400065834767],
                                [13.436396236149374, 52.133909970825],
                                [13.438920191823492, 52.133721578832514],
                                [13.441419866154195, 52.13343622710048],
                                [13.443885378429728, 52.13305504363173],
                                [13.44630698364028, 52.132579535220536],
                                [13.448675111170244, 52.13201158146763],
                                [13.450980402784642, 52.13135342731493],
                                [13.45321374975627, 52.13060767413072],
                                [13.45536632898408, 52.12977726938105],
                                [13.45742963795751, 52.128865494929215],
                                [13.459395528426471, 52.12787595401042],
                                [13.4612562386424, 52.126812556934475],
                                [13.463004424041742, 52.12567950557393],
                                [13.464633186250005, 52.12448127670013],
                                [13.46613610029165, 52.12322260423443],
                                [13.467507239898643, 52.12190846048569],
                                [13.468741200818615, 52.12054403644945],
                                [13.469833122031865, 52.11913472124779],
                                [13.470778704795304, 52.11768608079215],
                                [13.471574229440366, 52.116203835754234],
                                [13.47221656986127, 52.11469383893336],
                                [13.472703205639505, 52.113162052109935],
                                [13.47303223176004, 52.1116145224775],
                                [13.473202365884573, 52.110057358746964],
                                [13.473212953156994, 52.10849670701751],
                                [13.473063968526125, 52.106938726510215],
                                [13.47275601658072, 52.10538956525981],
                                [13.472290328901481, 52.10385533586084],
                                [13.47166875894477, 52.10234209136373],
                                [13.470893774482105, 52.100855801415406],
                                [13.469968447629268, 52.09940232873846],
                                [13.468896442507948, 52.09798740604074],
                                [13.467682000591953, 52.096616613446],
                                [13.466329923798925, 52.09529535653376],
                                [13.464845555396888, 52.09402884507396],
                                [13.463234758803189, 52.09282207253925],
                                [13.461503894361346, 52.09167979647492],
                                [13.459659794188664, 52.0906065198023],
                                [13.457709735194715, 52.08960647312848],
                                [13.455661410377452, 52.08868359813076],
                                [13.453522898509938, 52.087841532080155],
                                [13.451302632336613, 52.08708359356387],
                                [13.44900936540335, 52.08641276946172],
                                [13.446665810329549, 52.08583477278266],
                                [13.446666666666667, 52.08583333333333],
                                [13.420555555555556, 52.080000000000005],
                                [13.420555555555556, 52.08],
                                [13.418144107101925, 52.079510347728736],
                                [13.41568743484834, 52.07911466594883],
                                [13.413195219601796, 52.07881451371908],
                                [13.410677281530655, 52.07861107366669],
                                [13.408143541652363, 52.0785051473506],
                                [13.405603982933657, 52.07849715211877],
                                [13.403068611152772, 52.07858711947217],
                                [13.400547415673998, 52.078774694941245],
                                [13.398050330285315, 52.079059139475554],
                                [13.395587194249517, 52.07943933234118],
                                [13.39316771371857, 52.079913775514875],
                                [13.390801423659592, 52.080480599557895],
                                [13.388497650439126, 52.081137570947064],
                                [13.386265475209939, 52.08188210083487],
                                [13.38411369824184, 52.08271125520473],
                                [13.382050804334614, 52.08362176638256],
                                [13.380084929447257, 52.084610045860025],
                                [13.378223828673466, 52.08567219838021],
                                [13.376474845688389, 52.08680403723114],
                                [13.37484488378639, 52.08800110068828],
                                [13.37334037862379, 52.08925866954211],
                                [13.371967272774393, 52.090571785643114],
                                [13.370730992198835, 52.091935271391996],
                                [13.369636424721946, 52.09334375009982],
                                [13.368687900604655, 52.09479166713833],
                                [13.367889175289328, 52.096273311798605],
                                [13.367243414389232, 52.09778283977243],
                                [13.366753180984274, 52.09931429616867],
                                [13.366420425276523, 52.10086163897456],
                                [13.36624647664992, 52.10241876286996],
                                [13.366232038169338, 52.103979523301135],
                                [13.366377183544717, 52.10553776071923],
                                [13.366681356576375, 52.10708732488817],
                                [13.367143373087805, 52.10862209916584],
                                [13.367761425342541, 52.110136024662914],
                                [13.368533088931656, 52.111623124183275],
                                [13.369455332108625, 52.11307752585144],
                                [13.37052452753841, 52.11449348633292],
                                [13.371736466417834, 52.11586541355545],
                                [13.373086374914568, 52.11718788883997],
                                [13.374568932862623, 52.11845568835375],
                                [13.376178294642832, 52.11966380379944],
                                [13.377908112167779, 52.12080746225737],
                                [13.379751559881802, 52.12188214510163],
                                [13.381701361678296, 52.12288360591405],
                                [13.383749819628392, 52.12380788732388],
                                [13.385888844407432, 52.124651336705746],
                                [13.388109987298469, 52.1254106206724],
                                [13.390404473645217, 52.12608273830403],
                                [13.392763237620747, 52.12666503306055],
                                [13.392776920473388, 52.12666810613394],
                                [13.392777777777777, 52.126666666666665],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });

    test('parse airspace with counter-clockwise arc geometry', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/arc-counterclockwise-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: 'f037563e-26d3-4c37-a246-3667259ae966',
                    properties: {
                        name: 'ED-R37B_2 Nordhorn NOTAM',
                        class: 'R',
                        upperCeiling: {
                            value: 100,
                            unit: 'FL',
                            referenceDatum: 'STD',
                        },
                        lowerCeiling: {
                            value: 4000,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [7.063611111111111, 52.7175],
                                [7.252777777777778, 52.68333333333333],
                                [7.296666666666667, 52.49194444444444],
                                [7.296542956171171, 52.491869586055905],
                                [7.293395896926528, 52.49373637199246],
                                [7.286985276535472, 52.49719249589972],
                                [7.2802298709794, 52.5003963576714],
                                [7.273156387291307, 52.50333525667796],
                                [7.265792810750007, 52.50599754019928],
                                [7.258168293344321, 52.508372650272996],
                                [7.250313037284236, 52.51045116617362],
                                [7.242258174041408, 52.512224842342206],
                                [7.234035639424305, 52.51368664160448],
                                [7.225678045213872, 52.51483076353597],
                                [7.2172185479033315, 52.515652667852116],
                                [7.2086907151010475, 52.51614909272359],
                                [7.200128390167527, 52.51631806793777],
                                [7.191565555667009, 52.51615892285001],
                                [7.183036196220349, 52.51567228909044],
                                [7.174574161349032, 52.514860098014644],
                                [7.166213028900287, 52.513725572909145],
                                [7.157985969640083, 52.51227321598536],
                                [7.149925613594699, 52.510508790217784],
                                [7.14206391871233, 52.50843929610446],
                                [7.13443204240395, 52.50607294344948],
                                [7.127060216507661, 52.50341911828812],
                                [7.1199776262028935, 52.50048834509631],
                                [7.113212293380457, 52.497292244445156],
                                [7.10679096495152, 52.49384348628092],
                                [7.100739006553542, 52.49015573902836],
                                [7.095080302083937, 52.48624361473263],
                                [7.089837159463189, 52.482122610470924],
                                [7.08503022299845, 52.477809046279546],
                                [7.080678392686481, 52.473319999856045],
                                [7.076798750761442, 52.468673238308156],
                                [7.073406495758753, 52.46388714723237],
                                [7.0705148843310965, 52.45898065741479],
                                [7.06813518101714, 52.45397316945506],
                                [7.066276616127524, 52.44888447662137],
                                [7.064946351876799, 52.443734686250004],
                                [7.06414945685398, 52.438544140007096],
                                [7.06388888888889, 52.43333333333333],
                                [7.060833333333333, 52.43333333333333],
                                [7.057777777777778, 52.653055555555554],
                                [7.063611111111111, 52.7175],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });
});

describe('test parse invalid airspace definition blocks', () => {
    test('airspace with invalid geometry with self intersection results in error', async () => {
        const openairParser = new Parser();
        await openairParser.parse('./tests/fixtures/circular-invalid-airspace.txt');

        expect(() => {
            openairParser.toGeojson();
        }).toThrowError(
            "Geometry of airspace 'ED-R4 Wannsee H24' starting on line 1 is invalid due to a self intersection"
        );
    });

    test('airspace with invalid geometry with self intersection can be fixed', async () => {
        const openairParser = new Parser({ fixGeometry: true });
        await openairParser.parse('./tests/fixtures/circular-invalid-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: '54111756-48d4-4284-90d1-5ca4e9352b6a',
                    properties: {
                        name: 'ED-R4 Wannsee H24',
                        class: 'R',
                        upperCeiling: {
                            value: 2200,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                        lowerCeiling: {
                            value: 0,
                            unit: 'FT',
                            referenceDatum: 'GND',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [13.130649865341088, 52.377144584266844],
                                [13.127210916986305, 52.37716429305167],
                                [13.12378076338179, 52.37731568240125],
                                [13.120372911348609, 52.377598156200435],
                                [13.117000780486123, 52.37801060215574],
                                [13.113677650677065, 52.37855139614575],
                                [13.110416610124268, 52.37921840857398],
                                [13.107230504117156, 52.38000901269997],
                                [13.104131884723595, 52.38092009491697],
                                [13.101132961599593, 52.38194806693703],
                                [13.098245554105528, 52.38308887983683],
                                [13.095481044913097, 52.38433803991106],
                                [13.092850335282149, 52.38569062627216],
                                [13.090363802180713, 52.387141310129714],
                                [13.08803125741519, 52.38868437567502],
                                [13.085861908930717, 52.39031374249125],
                                [13.083864324433948, 52.39202298940263],
                                [13.08204639748246, 52.393805379671164],
                                [13.080415316176046, 52.39565388744344],
                                [13.078977534575916, 52.39756122534567],
                                [13.0777387469679, 52.39951987311996],
                                [13.076703865075316, 52.401522107190644],
                                [13.075876998316438, 52.40356003104609],
                                [13.075261437189976, 52.40562560631734],
                                [13.074859639860442, 52.40771068443251],
                                [13.074673222003018, 52.40980703872298],
                                [13.074702949955135, 52.41190639685556],
                                [13.074948737209253, 52.4140004734632],
                                [13.075409644268253, 52.416081002845736],
                                [13.07608388187172, 52.41813977161164],
                                [13.076968817587904, 52.42016865113139],
                                [13.078060985752904, 52.42215962967424],
                                [13.079356100724818, 52.42410484410022],
                                [13.08084907340737, 52.42599661098137],
                                [13.082534030983956, 52.42782745702801],
                                [13.084404339789765, 52.429590148698175],
                                [13.086452631236657, 52.431277720871805],
                                [13.088670830692438, 52.43288350447418],
                                [13.091050189203902, 52.43440115293777],
                                [13.093581317940671, 52.435824667395686],
                                [13.096254225225309, 52.43714842050491],
                                [13.099058356003981, 52.438367178803084],
                                [13.101982633601292, 52.43947612350817],
                                [13.10501550359299, 52.440470869676766],
                                [13.108144979620922, 52.4413474836428],
                                [13.11135869096603, 52.44210249866637],
                                [13.114643931687416, 52.442732928728255],
                                [13.117987711128498, 52.44323628041438],
                                [13.12137680558527, 52.44361056284152],
                                [13.124797810926324, 52.44385429558378],
                                [13.128237195950215, 52.44396651456741],
                                [13.131681356262218, 52.44394677590994],
                                [13.135116668450467, 52.44379515768797],
                                [13.138529544339773, 52.443512259626075],
                                [13.141906485101396, 52.443099200708666],
                                [13.145234134997501, 52.44255761472392],
                                [13.148499334540686, 52.44188964375862],
                                [13.15168917285172, 52.441097929669965],
                                [13.154791039002065, 52.440185603569475],
                                [13.15779267213246, 52.439156273361974],
                                [13.160682210144197, 52.4380140093902],
                                [13.163448236766156, 52.43676332824378],
                                [13.16607982680787, 52.4354091747985],
                                [13.168566589416885, 52.43395690255866],
                                [13.170898709167503, 52.43241225238269],
                                [13.173066984817508, 52.430781329678],
                                [13.175062865579656, 52.42907058015761],
                                [13.176878484765421, 52.427286764256564],
                                [13.178506690669971, 52.42543693031131],
                                [13.179941074578963, 52.42352838661012],
                                [13.181175995790221, 52.421568672427064],
                                [13.182206603555793, 52.419565528155665],
                                [13.183028855862883, 52.41752686466191],
                                [13.183639534985332, 52.41546073197927],
                                [13.184036259750608, 52.41337528747034],
                                [13.184217494480746, 52.41127876358193],
                                [13.184182554579142, 52.40917943532192],
                                [13.184181160899863, 52.409159143027935],
                                [13.1375, 52.3775],
                                [13.134084067230118, 52.37725663365221],
                                [13.130649865341088, 52.377144584266844],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });

    test('airspace with invalid geometry with self intersection passes if not validated', async () => {
        const openairParser = new Parser({ fixGeometry: false, validateGeometry: false });
        await openairParser.parse('./tests/fixtures/circular-invalid-airspace.txt');
        const geojson = openairParser.toGeojson();

        const expectedJson = {
            type: 'FeatureCollection',
            features: [
                {
                    type: 'Feature',
                    // IMPORTANT feature Id value changes every time => remove for comparison
                    // id: 'a9aeae33-ba38-478a-a74e-8b255d309319',
                    properties: {
                        name: 'ED-R4 Wannsee H24',
                        class: 'R',
                        upperCeiling: {
                            value: 2200,
                            unit: 'FT',
                            referenceDatum: 'MSL',
                        },
                        lowerCeiling: {
                            value: 0,
                            unit: 'FT',
                            referenceDatum: 'GND',
                        },
                    },
                    geometry: {
                        type: 'Polygon',
                        coordinates: [
                            [
                                [13.1375, 52.3775],
                                [13.137500000000003, 52.377500000000005],
                                [13.134084067230118, 52.37725663365221],
                                [13.130649865341088, 52.377144584266844],
                                [13.127210916986305, 52.37716429305167],
                                [13.12378076338179, 52.37731568240125],
                                [13.120372911348609, 52.377598156200435],
                                [13.117000780486123, 52.37801060215574],
                                [13.113677650677065, 52.37855139614575],
                                [13.110416610124268, 52.37921840857398],
                                [13.107230504117156, 52.38000901269997],
                                [13.104131884723595, 52.38092009491697],
                                [13.101132961599593, 52.38194806693703],
                                [13.098245554105528, 52.38308887983683],
                                [13.095481044913097, 52.38433803991106],
                                [13.092850335282149, 52.38569062627216],
                                [13.090363802180713, 52.387141310129714],
                                [13.08803125741519, 52.38868437567502],
                                [13.085861908930717, 52.39031374249125],
                                [13.083864324433948, 52.39202298940263],
                                [13.08204639748246, 52.393805379671164],
                                [13.080415316176046, 52.39565388744344],
                                [13.078977534575916, 52.39756122534567],
                                [13.0777387469679, 52.39951987311996],
                                [13.076703865075316, 52.401522107190644],
                                [13.075876998316438, 52.40356003104609],
                                [13.075261437189976, 52.40562560631734],
                                [13.074859639860442, 52.40771068443251],
                                [13.074673222003018, 52.40980703872298],
                                [13.074702949955135, 52.41190639685556],
                                [13.074948737209253, 52.4140004734632],
                                [13.075409644268253, 52.416081002845736],
                                [13.07608388187172, 52.41813977161164],
                                [13.076968817587904, 52.42016865113139],
                                [13.078060985752904, 52.42215962967424],
                                [13.079356100724818, 52.42410484410022],
                                [13.08084907340737, 52.42599661098137],
                                [13.082534030983956, 52.42782745702801],
                                [13.084404339789765, 52.429590148698175],
                                [13.086452631236657, 52.431277720871805],
                                [13.088670830692438, 52.43288350447418],
                                [13.091050189203902, 52.43440115293777],
                                [13.093581317940671, 52.435824667395686],
                                [13.096254225225309, 52.43714842050491],
                                [13.099058356003981, 52.438367178803084],
                                [13.101982633601292, 52.43947612350817],
                                [13.10501550359299, 52.440470869676766],
                                [13.108144979620922, 52.4413474836428],
                                [13.11135869096603, 52.44210249866637],
                                [13.114643931687416, 52.442732928728255],
                                [13.117987711128498, 52.44323628041438],
                                [13.12137680558527, 52.44361056284152],
                                [13.124797810926324, 52.44385429558378],
                                [13.128237195950215, 52.44396651456741],
                                [13.131681356262218, 52.44394677590994],
                                [13.135116668450467, 52.44379515768797],
                                [13.138529544339773, 52.443512259626075],
                                [13.141906485101396, 52.443099200708666],
                                [13.145234134997501, 52.44255761472392],
                                [13.148499334540686, 52.44188964375862],
                                [13.15168917285172, 52.441097929669965],
                                [13.154791039002065, 52.440185603569475],
                                [13.15779267213246, 52.439156273361974],
                                [13.160682210144197, 52.4380140093902],
                                [13.163448236766156, 52.43676332824378],
                                [13.16607982680787, 52.4354091747985],
                                [13.168566589416885, 52.43395690255866],
                                [13.170898709167503, 52.43241225238269],
                                [13.173066984817508, 52.430781329678],
                                [13.175062865579656, 52.42907058015761],
                                [13.176878484765421, 52.427286764256564],
                                [13.178506690669971, 52.42543693031131],
                                [13.179941074578963, 52.42352838661012],
                                [13.181175995790221, 52.421568672427064],
                                [13.182206603555793, 52.419565528155665],
                                [13.183028855862883, 52.41752686466191],
                                [13.183639534985332, 52.41546073197927],
                                [13.184036259750608, 52.41337528747034],
                                [13.184217494480746, 52.41127876358193],
                                [13.184182554579142, 52.40917943532192],
                                [13.184181160899863, 52.409159143027935],
                                [13.18388888888889, 52.409166666666664],
                                [13.140833333333333, 52.385555555555555],
                                [13.1375, 52.3775],
                            ],
                        ],
                    },
                },
            ],
        };
        // remove feature id for comparison
        geojson.features.map((value) => delete value.id);

        expect(geojson).toEqual(expectedJson);
    });
});
